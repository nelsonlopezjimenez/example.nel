define(function(){if(window.bbcdotcom&&typeof bbcdotcom.objects!=="undefined"&&bbcdotcom.objects("bbcdotcom.av.emp.adverts","create")){bbcdotcom.av.emp.adverts=(function(){function s(x){var u=new RegExp(x+"=(.*?)(?:;|$)");var w=u.exec(document.cookie);var v=(w&&w.length?w[1]:false);return v}function q(){}function h(){var v="",u,w=window.ccauds;if(typeof w!=="undefined"){for(u=0;u<w.Profile.Audiences.Audience.length;u++){if(u>0){v+=","}v+=w.Profile.Audiences.Audience[u].abbr}return"ccaud%3D"+encodeURIComponent(v)+"%26"}else{return""}}function k(){if(typeof window.gs_channels!=="undefined"&&window.gs_channels!=="DEFAULT"){return"gs_cat%3D"+encodeURIComponent(window.gs_channels)+"%26"}else{return""}}function j(){var x,w=bbcdotcom.adverts.keyValues.getAll(),v="&cust_params=",u;for(x in w){if(w.hasOwnProperty(x)&&w[x]!==""){v+=x+"%3D"+w[x]+"%26"}}v+=h();v+=k();if(bbcdotcom.objects("bbcdotcom.adverts.adUnit.getPreviewUid")){u="uid="+bbcdotcom.adverts.adUnit.getPreviewUid();v+=encodeURIComponent(u)}if(bbcdotcom.config.getWindowLocation().pathname.match(/\/embed$/g)!==null){v+=encodeURIComponent("client=embedplayer")}return v}function b(u){}function p(v){var u;if(typeof BBC!=="undefined"&&typeof BBC.adverts!=="undefined"&&typeof BBC.adverts.empCompanion==="function"){u=BBC.adverts.empCompanion()}else{if(typeof bbcdotcom!=="undefined"&&typeof bbcdotcom.advert!=="undefined"&&typeof bbcdotcom.advert.getPrerollAdTag==="function"){u=bbcdotcom.advert.getPrerollAdTag(bbcdotcom.adUnit)}else{if(typeof bbcdotcom!=="undefined"&&typeof bbcdotcom.objects!=="undefined"&&bbcdotcom.objects("bbcdotcom.adverts.adUnit.get")&&bbcdotcom.objects("bbcdotcom.adverts.keyValues.getAll")){u="http://pubads.g.doubleclick.net/gampad/ads?sz=512x288&iu="+bbcdotcom.adverts.adUnit.get()+j()+"&env=vp&gdfp_req=1&impl=s&output=xml_vast3&unviewed_position_start=1&ord="+(Math.floor(Math.random()*1000000000))+"&url="+encodeURIComponent(encodeURIComponent(bbcdotcom.config.getWindowLocation().href))+"&ad_rule=1"}}}return u}function n(w){var u=p();var v=new RegExp(/(ad_rule=)\d{1}/g);if(v.test(u)===false){u=u+"&ad_rule="+w||1}return u}function f(u){}function d(u){}function g(u){}function l(u){}function t(u){}function m(u){}function r(v,u){}function i(u,v){}function e(u){u.set("preroll",p())}function a(z,x){var y;var w=p();var v=s("bbcdotcomHtml5AdsDebug");var u={name:"AdsPluginParameters",data:{adTag:w,debug:v}};for(y in x){u.data[y]=x[y]}return u}function c(v,u){var w=u.settings();w.suppressItemKind=v;u.settings(w);return u}function o(y,x,w){var u,v=w||{};if(typeof x==="undefined"){return}if(x.loadPlugin!==undefined&&typeof x.loadPlugin==="function"){u=a(y,v);x.loadPlugin({html:"name:dfpAds.js",swf:"name:dfpAds.swf"},u)}c(["ident"],x)}return{getPrerollAdTag:p,getPrerollAdTagWithAdRule:n,setupCompanionSlots:f,enableCompanions:q,getCompanionSlotId:d,getCompanionSlots:g,encodeCompanionSlots:l,decodeCompanionSlots:t,defineCompanionSlots:m,setCompanionFlashVars:i,playerBeforeEachWrite:e,addSmpPlugin:o}}());return bbcdotcom.av.emp.adverts}});